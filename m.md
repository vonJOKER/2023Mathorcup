问题一）预测模型，2年数据预测30步，各线路分别预测，给出3条线路结果

问题二）要求变化线路尽可能少，工作负荷尽可能均衡（工作负荷好像要自己定义），每天没有正常流转包裹尽可能少

到DC5的换线，DC5出去的换线，地铁线路规划？

选变化趋势较大的几条线路分配包裹，工作负荷均匀就选个百分比或者平均一下

问题三）动态规划没思路

问题四）线路重要性评价，变化大的重要，基本都是满的相对不重要？

新增场地和路线















第一问，预测各路线在2023.01.01-2023.01.31期间每条线路每天的货量

观察每条线路的数据量，我们首先应当对线路进行分类，例如DC1$\to$DC8这条线路仅在2022.10.08这天有一条数据：货量为3。对于这样的线路我们认为他是备用线路















数据预处理：DC14-DC10的数据缺失了2022.11.26和2022.11.27两个数据，

2021/8/7之前货量太少，我们不将它作为数据集的一部分。

我们采用ARIMA模型对2023.01.01-2023.01.31的货量进行预测，首先判断时间序列平稳性，如果时间序列不平稳我们要对其进行差分处理，我们采用ADF单位根平稳性和KPSS检验时间序列是否平稳：

1. $ADF$单位根检验

$ADF$单位根检验的基本原理是将时间序列的自回归系数拟合到一个回归方程中，并通过$t$检验来确定系数是否显著不等于0。如果系数显著不等于0，则表明序列不存在单位根，即是平稳的。

检验统计量如下：

$ADF(t) = (y_t - y_{t-1}) - \beta_1 (y_{t-1} - y_{t-2}) - ... - \beta_p (y_{t-p} - y_{t-p-1})$

其中，$y_t$是时间序列在时间点t的值，$\beta_1, ..., \beta_p$是自回归系数，$p$是阶数。检验统计量的期望和方差如下：

$E(ADF(t)) = 0$

$Var(ADF(t)) = \frac{\sigma_{\epsilon}^2}{T} \sum_{i=1}^T i^{-2}$

其中，$\sigma_{\epsilon}^2$是残差的方差，$T$是样本量。

$ADF$单位根检验的假设如下：

原假设$ H0$：序列存在单位根，即非平稳；

备择假设$H1$：序列不存在单位根，即平稳。

如果检验统计量$ADF(t)$的值小于某个临界值，就拒绝原假设，认为序列是平稳的。

​	2.$KPSS$检验

$KPSS$检验的基本原理是比较序列的实际走势和随机漫步（随机游走）的走势之间的差异，从而判断序列是否平稳。

检验统计量如下：

$KPSS(t) = \frac{1}{T \sigma^2} \sum_{i=1}^T \left(\sum_{j=1}^i (y_j - \bar{y})\right)^2$

其中，$y_t$是时间序列在时间点t的值，$\bar{y}$是时间序列的均值，$T$是样本量，$\sigma^2$是时间序列的方差。检验统计量的期望和方差如下：

$E(KPSS(t)) = \frac{T}{4}$

$Var(KPSS(t)) = \frac{T}{6} \left(1 - \frac{2}{T} \sum_{i=1}^{T/2} \frac{1}{i^2}\right)$

$KPSS$检验的假设如下：

原假设 $H0$：序列是平稳的；

备择假设 $H1$：序列是非平稳的。

如果检验统计量$KPSS(t)$的值大于某个临界值，就拒绝原假设，认为序列是非平稳的。



经检验原时间序列不平稳，我们对其进行一阶差分：

$y_t' = y_t - y_{t-1}$

其中，$y_t'$是一阶差分序列在时间点$t$的值，$y_t$和$y_{t-1}$分别是时间序列在时间点$t$和$t-1$的值。

经过一阶差分后，时间序列平稳，我们接下来再确定$p$和$q$的值。

对于$p,q$，我们考虑下列模型以下参数：

![image-20230413213947572](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230413213947572.png)













![image-20230413213522068](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230413213522068.png)

















第二问）

模型的建立

我们列出约束条件和目标函数，利用启发式算法求解，这样我们可以得到尽可能均衡的载货量、尽可能变化少的站点以及尽可能少的不能正常流转的货物。

我们设各个站点当天需要处理的货量为$X_D$，其中$D\in{}$，DC5当天的货量为$X_{DC5}$,因DC5关停导致发生变化的站点数量为$x_D$，各站点的最大承载量为$X_{D_m}$，我们定义站点的工作负荷计算如下：

$w_D=\frac{X_D'}{X_{D_m}}\times100\%,0\le w_D\le 1$

$X_D'=X_D+\Delta X_D$

$\sum\limits_D\Delta X_D\le X_{DC5}$

其中，$w_D$表示站点D的工作负荷，$X_D$表示我们在第一问中进行预测的各站点处理的货物量，$\Delta X_D$表示各站点因DC5关停所需额外处理的工作量，$X_D'$表示站点DC5关停后各站点所需处理的工作量。

我们计算各站点工作负荷的方差$Var_D$如下：

$Var_D=\sum\limits_D(w_D-\frac{\sum\limits_Dw_D}{x_D})$

为了让各站点工作负荷尽可能均衡，我们有：

$\min \ Var_D$

为了使站点变化数量尽可能少，我们有：

$\min \ x_D$

为了使货物尽可能正常流转，即日累计总量尽可能少，我们有：

$\min \ X_{DC5}-\sum\limits_DX_D$

对于以上三个目标函数，我们分别加以权重$W_1,W_2,W_3$：

$W_1+W_2+W_3=1$

于是我们得到了我们最终的目标函数：

$\min \ W_1\cdot Var_D+W_2\cdot x_D+W_3\cdot (X_{DC5}-\sum\limits_DX_D)$

模型的求解





















收货量$S_D$和发货量$F_D$。若发货量远大于收货量，我们有理由认为这个站点为始发站点；如果一个站点收货量和发货量几乎相等，那我们认为这个站点为中转站点；同理若这个站点收货量远大于发货量，那么我们认为这个站点为目的站点。于是我们对这三类站点选取不同评价指标归一化后再进行评价。



问题4

熵权法介绍

熵权法是一种常用的多指标权重确定方法，它可以将指标之间的相关性考虑进来，避免了传统加权平均方法中的主观性和不确定性，有效地考虑指标之间的相关性，避免传统加权平均方法中的主观性和不确定性。

其基本思想是将指标之间的熵值作为权重，越重要的指标熵值越小，从而实现对指标的优先排序和加权。运用熵权法我们就客观的得到了物流线路的重要性排序。

重要性求解

对物流场地和物流路线的重要性评价。对于物流线路重要性的分析，我们认为如果一条物流线路的货量越大，这条物流线路越重要；同理若这条线路负荷量越大，重要性也越高。于是我们对数据处理后进行分析，找到货量较高的一些站点再运用熵权法进行评分得到各线路重要性排序。对于物流场地而言，我们简单认为处理的平均货量越大则站点越重要。我们将得出的最重要的十条录像和十个站点列在文章中。

物流路线重要性排序：

```TeX
\begin{table}[h]
\centering
\caption{线路重要性排名}
\label{xlzyx}
\begin{tabular}{cc}
\hline
线路      & 重要性排名 \\ \hline
$DC14\to DC8 $   & 1     \\
$DC14\to DC9$  & 2     \\
$DC36\to DC10$   & 3     \\
$DC23 \to DC4$  & 4     \\
$DC23\to DC10$  & 5     \\
$DC19\to DC4$  & 6     \\
$DC17\to DC4 $ & 7     \\
$DC22\to DC10$  & 8     \\
$DC24\to DC3$   & 9     \\
$DC10\to DC23$  & 10    \\ \hline
\end{tabular}
\end{table}
```

物流场地重要性排序：

```TeX
\begin{table}[h]
\centering
\caption{站点重要性排名}
\label{zyx}
\begin{tabular}{ccc}
\hline
站点      & 平均货运量       & 重要性排名 \\ \hline
$DC14$    & 360728 & 1     \\
$DC10  $& 359481 & 2     \\
$DC4$   & 305181  & 3     \\
$DC8 $  & 257334  & 4     \\
$DC62$ & 123824 & 5     \\
$DC23$ & 101918 & 6     \\
$DC36 $ & 100918  & 7     \\
$DC17 $ & 96090 & 8     \\
$DC9 $  & 94691 & 9     \\
$DC19$ & 89820 & 10    \\ \hline
\end{tabular}
\end{table}
```

```Tex
\begin{table}[h]
\centering
\caption{问题2结果}
\label{wt2}
\begin{tabular}{lcc}
\hline
改变的线路&	改变后线路货量&	改变后线路负荷率 \\ \hline
$DC14\to DC8 $   & 285169  & 100$\%$  \\
$DC14\to DC9$  & 123279   & 100$\%$ \\
$DC36\to DC10$   & 85168  & 99.7$\%$  \\
$DC23 \to DC4$  & 61498   & 99.4$\%$ \\
$DC23\to DC10$  & 23157    &99.6$\%$\\\hline
\end{tabular}
\end{table}
```

```matlab
function [bestSolution, bestFitness] = quantumGA(nVar, nPop, maxIter)
% nVar: 优化问题的维度
% nPop: 种群大小
% maxIter: 最大迭代次数

% 初始化量子比特数量和种群
nBits = ceil(log2(1+1/nPop));
pop = zeros(nPop, nBits*nVar);

% 初始化种群
for i=1:nPop
    for j=1:nVar
        % 随机生成二进制编码
        pop(i,(j-1)*nBits+1:j*nBits) = dec2bin(randi([0 2^nBits-1]), nBits);
    end
end

% 迭代寻优
for iter=1:maxIter

    % 计算种群中每个个体的适应度值

    % 找到种群中的最佳个体

    % 量子比特旋转

end
end
%%



% 将最佳个体转换为实数值并返回
bestSolution = zeros(1,nVar);
bestFitness = objectiveFunction(bestSolution);

end

function [bestSolution, bestFitness] = quantumGA(nVar, nPop, maxIter)
% nVar: 优化问题的维度
% nPop: 种群大小
% maxIter: 最大迭代次数

% 初始化量子比特数量和种群
nBits = ceil(log2(1+1/nPop));
pop = zeros(nPop, nBits*nVar);

% 迭代寻优
for iter=1:maxIter

    % 计算种群中每个个体的适应度值

    % 找到种群中的最佳个体

    % 量子比特旋转

end

% 将最佳个体转换为实数值并返回
bestSolution = zeros(1,nVar);
bestFitness = objectiveFunction(bestSolution);

end
end
%%

function [bestSolution, bestFitness] = quantumGA(nVar, nPop, maxIter)
% nVar: 优化问题的维度
% nPop: 种群大小
% maxIter: 最大迭代次数

% 初始化量子比特数量和种群
nBits = ceil(log2(1+1/nPop));
pop = zeros(nPop, nBits*nVar);

% 初始化种群
for i=1:nPop
    for j=1:nVar
        % 随机生成二进制编码
        pop(i,(j-1)*nBits+1:j*nBits) = dec2bin(randi([0 2^nBits-1]), nBits);
    end
end

% 迭代寻优
for iter=1:maxIter

    % 计算种群中每个个体的适应度值
    fitnessValues = zeros(nPop,1);
    for i=1:nPop
        solution = zeros(1,nVar);
        for j=1:nVar
            % 将二进制编码转换为实数值
            solution(j) = bin2dec(pop(i,(j-1)*nBits+1:j*nBits))/(2^nBits-1);
        end
        fitnessValues(i) = objectiveFunction(solution);
    end

    % 找到种群中的最佳个体
    [bestFitness, bestIndex] = min(fitnessValues);
    bestSolution = zeros(1,nVar);
    for j=1:nVar
        bestSolution(j) = bin2dec(pop(bestIndex,(j-1)*nBits+1:j*nBits))/(2^nBits-1);
    end

    % 量子比特旋转
    for i=1:nPop
        for j=1:nVar
            % 将二进制编码转换为实数值
            solution(j) = bin2dec(pop(i,(j-1)*nBits+1:j*nBits))/(2^nBits-1);
        end
        fitness = fitnessValues(i);
        % 计算概率分布
        p = (fitness - bestFitness)/(max(fitnessValues) - bestFitness);
        % 量子比特旋转
        if rand() < p
            pop(i,(j-1)*nBits+1:j*nBits) = complement(pop(i,(j-1)*nBits+1:j*nBits));
        end
    end

end

% 将最佳个体转换为实数值并返回
bestFitness = objectiveFunction(bestSolution);

end

% 辅助函数，对二进制编码进行补码操作
function y = complement(x)
y = x;
for i=1:length(x)
    if x(i) == '0'
        y(i) = '1';
    else
        y(i) = '0';
    end
end
end
function y = objectiveFunction(x)
y = sin(5*pi*(x-1.3))./(5*pi*(x-1.3)+eps);
end
```



对于新增的物流场地应该与哪几个已有物流线路之间新增路线，我们首先应当考虑与物流量大的线路和负荷率高的线路，这样可以有效的降低高负荷高货量的物流线路的压力，也能减轻一些物流站点的所需的处理货量的压力。根据我们对各物流线路和场地的评价，注意到站点$DC14,DC10$和$DC4$三个站点的货量压力很大，同时与它们相关的线路也很重要。我们新增的站点应当与这三个站点间建立联系。又注意到线路集合$L_{DC14D_j}$中有两条很重要的线路$DC14\to DC8,DC14\to DC9$。这两条线路如果出现故障对于站点$DC14$的压力将会大大增加，所以我们的第一条线路就应当是在这两条路线出现故障时能够有效缓解该站点的压力。假设我们新建立的站点为$DCX$，我们的第一对路线就是$DCX\to DC14$和$DC14\to DCX$。

通过上述分析，我们紧接着注意到两个路线集合$L_{DC_iDC10}$和$L_{DC_iDC4}$，所以我们的剩下两对路线就随之确定了，分别为$DC10\to DCX,DC4\to DCX$和$DCX\to DC10,DCX\to DC4$。接下来我们还需考虑该站点的处理能力和新增路线的运输能力。

对于新建站点的处理能力，在不新增这个站点时物流网络能够正常运行，所以我们对该物流站点的处理能力似乎不需要太过担心。但是它又同时连接了三条最重要的站点，正如上面所说，在其中任意一个站点发生故障的情况下，我们都应当利用这个新增的站点来减轻我们物流网络的负荷并且保证包裹尽可能正常流转。这也同时能够保证更少的物流线路发生改变，所以我们的这个物流站点至少应该有三个站点中一个的处理能力—保证始终能够有三个最重要的站点在正常运行。我们通过附件一的数据得出这三个站点平均处理货量为341797，所以我们的站点$DCX$应该有负荷货量$341797$件的能力，四个站点均正常时每天也能够处理货量$256347$件。

对于新增路线的处理能力，如果运输能力太强，在三个站点均正常运行时，我们的物流路线就会造成资源的浪费；而如果运输能力太弱，若三个站点中有某个站点停运时，那么我们的新增路线就不能很好地应对这种情况，这与我们新增路线地初心相悖。这两种极端情况都是我们不愿意看到的，所以我们要在两者间取一个较优值对两种情况均能得到令人较为满意的结果。我们尝试在每年总货物量没有发生较大的突变的情况下使新增路线能够较好地融入原物流网络。又考虑到站点正常运行概率应该远远大于某站点停运的概率。于是我们让在四个站点均正常运行时重要的几条线路加上我们新增路线的负荷尽可能均衡。基于以上分析我们得到了新增路线的运输能力在表\ref{xz}中：

|   新增路线    | 运输能力 |
| :-----------: | :------: |
| $DCX\to DC14$ |  27776   |
| $DC14\to DCX$ |          |
| $DC10\to DCX$ |  25815   |
| $DCX\to DC10$ |          |
| $DC4\to DCX$  |  22702   |
| $DCX\to DC4$  |          |

















对于我们的目标函数，当站点 𝐷𝐶5 正常运转时，我们的目标函数能够达到最小值
为 0，当站点 𝐷𝐶5 停运时，我们将 𝐷𝐶5 包裹均匀分配到所有路线上，得到我们的初
始解，此时我们目标函数达到最大值为 3．接下来我们利用遗传算法进行求解，得出最
终的目标函数能够达到全局较优解使目标函数值达到 1.161．我们求得的最优分配方案
使得未能正常流转的货物量为 0，改变的线路及货量和改变后线路的平均负荷率展示在
表2中，遗传算法求解目标函数最小值展示在图2：







对于我们的目标函数，当站点$DC9$正常运行时，我们的目标函数能够达到最大值为0，在站点$DC9$停运后，我们将与$DC9$相关路线包裹平均分配到每条路线上并且不新开线路也不进行动态调整，此时目标函数取得最小值为-3。在此基础上我们利用量子遗传算法进行求解，得出最终目标函数的最大值达到-1.15。目标函数平均最大值也能达到-1.15。在第2，3，8，9天新开路线$DC14\to DC28$，其余时间没有新开或关闭路线，没有未能流转的包裹量。我们改变的线路及货量和改变后线路平均负荷率展示在表\ref{dc9}，量子遗传算法求解目标函数最大值展示在图\ref{lzycsf}中:

```tex
\begin{table}[h]
\centering
\caption{问题3结果}
\label{dc9}
\begin{tabular}{lcc}
\hline
改变的线路&	新增的货量&	改变后线路平均负荷率 \\ \hline
$DC14\to DC28$(新开路线)&72995976&100
$DC14\to DC8 $   & 185169  & 100$\%$  \\
$DC14\to DC28$  & 124356   & 100$\%$ \\
$DC36\to DC4$   & 83242  & 98.4$\%$  \\\hline
\end{tabular}
\end{table}
```

在某些物流场地或物流线路停运时现代物流网络需要进行紧急调整，预测何时调整，怎么调整能够最大程度上保证物流网络的正常运行。本文利用某物流网络历史货量数据通过时间序列预测模型对未来货量进行预测，利用机器寻优算法解决在某站点临时停运情况下该物流网络的调整策略。

在问题1中，我们对数据进行预处理后将数据集划分为不同路线每日货量的数据集，建立$ARIMA$模型预测各线路在2023.01.01至2023.01.31的货量数据，其中三条线路货量的数据结果见表\ref{a}。

在问题2中，我们将尽可能均衡的工作负荷，尽可能少的变化的线路以及尽可能少的未能正常流通的包裹数量转化为三个目标函数，将各线路最大货量、各线路每日货量等作为约束条件建立多目标规划模型。接着我们利用$FNS$方法将多目标规划问题转化为单目标规划问题，再利用遗传算法来寻找目标函数的最优值。我们的分配方案使得在站点$DC5$关停后未能正常流转的货物日累计量达到0。货量发生变化的线路和改变后线路的平均负荷率见表\ref{wt2}。

在问题3中，我们考虑到允许对物流网络结构进行动态调整，在第2问目标函数进行调整，继续增加约束条件以建立多目标规划模型，再利用$FNS$方法转化为单目标规划模型。最后我们建立量子遗传算法的机器寻优模型对我们的规划模型进行求解。我们得出应在$2023.01.02,2023.01.03,2023.01.08,2023.01.09$新增路线$DC14\to DC28$，我们的调整策略使得包裹全部能够正常流转。货量发生变化的线路和改变后线路的平均负荷率见表\ref{dc9}。

在问题4中，我们建立评价模型得出各线路和站点的重要性排名，得出最重要的三条线路为$DC14\to DC8,DC14\to DC9,DC36\to DC10$，最重要的三个站点为$DC14,DC10,DC4$（具体排名见表\ref{xlzyx}和表\ref{zyx}）。在建立新站点$DCX$后我们分析得出最优的与它相关的线路以及处理货量能力和运输货量能力的设置。

















